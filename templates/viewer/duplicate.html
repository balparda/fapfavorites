<!DOCTYPE html>
<html lang='en-US'>
  <head>
    <meta charset='utf-8'/>
    <title>
      Imagefap-Favorites: {% if current_index == -1 %}Exact Duplicate{% else %}Perceptual Duplicate Set{% endif %}
    </title>
  <style>

    th, td {padding: 5px;}

    a.external {text-decoration: none;}

  </style>
  </head>
  <body bgcolor='black' text='lightgray'>

    <h1>
      {% if current_index == -1 %}Exact Duplicate{% else %}Perceptual Duplicate Set{% endif %}
    </h1>

    {% if error_message %}
      <p style='color: red;'><strong>{{ error_message }}</strong></p>
      <p>&nbsp;</p>
    {% endif %}

    {% load static %}

    <p>
      The link icon (<small><small>&#128279;</small></small>) will take you to Imagefap original image: <b><i>beware</i></b>, as clicking will open Imagefap site!
    </p>

    <form action='{% url "duplicate" digest %}' method='post'>
      {% csrf_token %}

      <table border='2'>
        <tr>
          <th>Image</th>
          <th>Size&nbsp;Info<br/>FapID&nbsp;/&nbsp;User&nbsp;/&nbsp;Album</th>
          {% if current_index != -1 %}
            <th>Action</th>
          {% endif %}
        </tr>
        {% for sha, obj in duplicates.items %}
          <tr>
            <td colspan='3' style='font-family:monospace'>
              {{ sha }}<br/>&nbsp;#{{ obj.percept }}
            </td>
          </tr>
          <tr>
            <td align='center' valign='center'>
              <a href='{% url "blob" sha %}' target='_blank' rel='noopener noreferrer'>
                <img src='{% static obj.thumb %}'/>
              </a>
            </td>
            <td>
              <table border='1'>
                <tr><td colspan='4'>{{ obj.dimensions }}</td></tr>
                <tr><td colspan='4'>{{ obj.sz }}</td></tr>
                {% if obj.tags %}
                  <tr><td colspan='4'>{{ obj.tags }}</td></tr>
                {% endif %}
                {% for location in obj.loc %}
                  <tr>
                    <td>{{ location.fap_id }}</td>
                    <td><a href='{% url "favorites" location.user_id %}'>{{ location.user_name|escape }}</a></td>
                    <td><a href='{% url "favorite" location.user_id location.folder_id %}'>{{ location.folder_name|escape }}</a></td>
                    <td><small><a href='{{ location.imagefap }}' class='external' title='Image in Imagefap' target='_blank' rel='noopener noreferrer'>&#128279;</a></small></td>
                  </tr>
                {% endfor %}
              </table>
            </td>
            {% if current_index != -1 %}
              <td>
                <fieldset>
                  <input type='radio' name='{{ sha }}' id='action_{{ forloop.counter }}_new' value='new' {% if obj.action == 'new' %}checked{% endif %}>
                  <label for='action_{{ forloop.counter }}_new'>new&nbsp;&#10067;&nbsp;(no user choice yet)</label><br/>
                  <input type='radio' name='{{ sha }}' id='action_{{ forloop.counter }}_false' value='false' {% if obj.action == 'false' %}checked{% endif %}>
                  <label for='action_{{ forloop.counter }}_false'>false&nbsp;positive&nbsp;&#9989;&nbsp;(images are not the same, I want to see them)</label><br/>
                  <input type='radio' name='{{ sha }}' id='action_{{ forloop.counter }}_keep' value='keep' {% if obj.action == 'keep' %}checked{% endif %}>
                  <label for='action_{{ forloop.counter }}_keep'>keep&nbsp;image&nbsp;&#9989;&nbsp;(I want to see this one, even if repeated)</label><br/>
                  <input type='radio' name='{{ sha }}' id='action_{{ forloop.counter }}_skip' value='skip' {% if obj.action == 'skip' %}checked{% endif %}>
                  <label for='action_{{ forloop.counter }}_skip'>skip&nbsp;image&nbsp;&#10060;&nbsp;(I don't want to see this one)</label>
                </fieldset>
              </td>
            {% endif %}
          </tr>
        {% empty %}
          <tr><td colspan='{% if current_index == -1 %}2{% else %}3{% endif %}'>Duplicate set is empty: SHOULD NEVER HAPPEN!</td></tr>
        {% endfor %}
      </table>

      {% if current_index != -1 %}
        <p><input type='submit' value='Save'></p>
      {% endif %}

    </form>

    {% if current_index != -1 %}
      <p>{% if previous_key %}<a href='{% url "duplicate" previous_key.0 %}'>&#11013;&nbsp;&nbsp;PREV</a>&nbsp;&nbsp;{% endif %}&nbsp;&nbsp;&#10037;&nbsp;&nbsp;<a href='{% url "duplicates" %}'>&#11014;</a>&nbsp;&nbsp;&#10037;&nbsp;&nbsp;{% if next_key %}&nbsp;&nbsp;<a href='{% url "duplicate" next_key.0 %}'>NEXT&nbsp;&nbsp;&#10145;</a>{% endif %}</p>
    {% endif %}

    <p><a href='{% url "index" %}'>(Go To: Home Page)</a></p>

  </body>
</html>
